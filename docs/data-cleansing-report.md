# è³‡æ–™æ¸…ç†å°ˆæ¡ˆå ±å‘Š

> **å°ˆæ¡ˆåç¨±**ï¼šETL Data Lake è³‡æ–™æ¸…ç†  
> **åŸ·è¡ŒæœŸé–“**ï¼š2026-02-05 ~ 2026-02-07  
> **åŸ·è¡Œè€…**ï¼šmeimei (AI Data Engineer)  
> **è³‡æ–™åº«**ï¼šPostgreSQL (AWS RDS)

---

## ç›®éŒ„

1. [å°ˆæ¡ˆæ¦‚è¿°](#1-å°ˆæ¡ˆæ¦‚è¿°)
2. [æ¶æ§‹è¨­è¨ˆ](#2-æ¶æ§‹è¨­è¨ˆ)
3. [æ¸…ç†é‚è¼¯](#3-æ¸…ç†é‚è¼¯)
4. [åŸ·è¡Œæˆæœ](#4-åŸ·è¡Œæˆæœ)
5. [è³‡æ–™å“è³ªæª¢æ¸¬](#5-è³‡æ–™å“è³ªæª¢æ¸¬)
6. [å»ºè­°äº‹é …](#6-å»ºè­°äº‹é …)
7. [é™„éŒ„](#7-é™„éŒ„)

---

## 1. å°ˆæ¡ˆæ¦‚è¿°

### 1.1 ç›®æ¨™

å°‡ ERP ç³»çµ±çš„åŸå§‹è³‡æ–™é€²è¡Œæ¸…ç†ã€æ¨™æº–åŒ–ï¼Œå»ºç«‹çµ±ä¸€çš„è³‡æ–™æ•´ç†å±¤ï¼ˆClean Layerï¼‰ï¼Œä¾›å¾ŒçºŒ API æœå‹™èˆ‡ AI æª¢ç´¢ä½¿ç”¨ã€‚

### 1.2 ç¯„åœ

| ä¾†æºç³»çµ± | åŸå§‹è¡¨ | æ¸…ç†å¾Œè¡¨ | èªªæ˜ |
|----------|--------|----------|------|
| ERP | erp_m2201_ima_file | material_master | æ–™ä»¶ä¸»æª” |
| ERP | erp_m2201_gem_file | department_master | éƒ¨é–€ä¸»æª” |
| ERP | erp_m2201_gen_file | employee_master | å“¡å·¥åŸºæœ¬è³‡æ–™ |

### 1.3 è³‡æ–™è¦æ¨¡

| æŒ‡æ¨™ | æ•¸å€¼ |
|------|------|
| åŸå§‹è³‡æ–™åº«å¤§å° | ~4.6 GB |
| æ¸…ç†è¡¨ç¸½ç­†æ•¸ | 2,781 ç­† |
| æ¸…ç†è¡¨ç¸½æ•¸ | 3 å¼µ |
| Metadata è¡¨ | 7 å¼µ |

---

## 2. æ¶æ§‹è¨­è¨ˆ

### 2.1 Medallion Architecture

æ¡ç”¨ç°¡åŒ–çš„ **Medallion Architecture** é›™å±¤æ¶æ§‹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Medallion Architecture                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   ğŸ“¦ source (Bronze å±¤)          ğŸ“¦ clean (Silver å±¤)            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚ â€¢ åŸå§‹ ERP è³‡æ–™      â”‚ â”€â”€â”€â–º â”‚ â€¢ æ¸…ç†æ¨™æº–åŒ–è³‡æ–™     â”‚        â”‚
â”‚   â”‚ â€¢ ä¿æŒä¾†æºæ ¼å¼       â”‚       â”‚ â€¢ è‹±æ–‡æ¬„ä½å‘½å       â”‚        â”‚
â”‚   â”‚ â€¢ 277+ æ¬„ä½/è¡¨       â”‚       â”‚ â€¢ ç²¾ç°¡æœ‰æ„ç¾©æ¬„ä½     â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                          â”‚                       â”‚
â”‚                                          â–¼                       â”‚
â”‚                                  ğŸ“¦ mart (Gold å±¤)               â”‚
â”‚                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚                                  â”‚ â€¢ å ±è¡¨ç”¨ç¶­åº¦è¡¨       â”‚        â”‚
â”‚                                  â”‚ â€¢ API æŸ¥è©¢å„ªåŒ–       â”‚        â”‚
â”‚                                  â”‚ â€¢ (å¾…å»ºç«‹)           â”‚        â”‚
â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Schema çµæ§‹

```
ğŸ“¦ è³‡æ–™åº«ï¼šsource
â”œâ”€â”€ ğŸ“ source schema (åŸå§‹å±¤)    â†’ 55 å¼µè¡¨, 2.2 GB
â”œâ”€â”€ ğŸ“ public schema (è™•ç†ä¸­)    â†’ 153 å¼µè¡¨, 2.4 GB
â”œâ”€â”€ ğŸ“ clean schema (æ¸…ç†å±¤)     â†’ 3 å¼µè³‡æ–™è¡¨ + 7 å¼µ Metadata
â”œâ”€â”€ ğŸ“ mart schema (æ‡‰ç”¨å±¤)      â†’ (å¾…å»ºç«‹)
â””â”€â”€ ğŸ“ temp schema (æš«å­˜)        â†’ 9 å¼µè¡¨
```

### 2.3 Metadata è¡¨è¨­è¨ˆ

| è¡¨å | ç”¨é€” | ç­†æ•¸ |
|------|------|------|
| `_metadata_table` | è¡¨ç´šè³‡è¨Š | 3 |
| `_metadata_column` | æ¬„ä½è³‡è¨Š | 60+ |
| `_metadata_column_mapping` | æ¬„ä½è¡€ç·£å°ç…§ | 50+ |
| `_metadata_cleansing_rules` | è‡ªè¨‚æ¸…ç†è¦å‰‡ | 7 |
| `_metadata_validation_rules` | é©—è­‰è¦å‰‡ | 8 |
| `_metadata_statistics` | ETL çµ±è¨ˆç›£æ§ | 3 |
| `_cleansing_log` | æ¸…ç†è¨˜éŒ„ | 4 |

---

## 3. æ¸…ç†é‚è¼¯

### 3.1 æ¸…ç†å±¤ç´š

ä¾ç…§ Medallion Architecture è¨­è¨ˆæ–‡ä»¶ï¼Œæ¡ç”¨å››å±¤æ¸…ç†æ©Ÿåˆ¶ï¼š

| å±¤ç´š | åç¨± | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|------|
| 1 | æ ¼å¼æ¸…ç† | å»ç©ºç™½ã€å…¨åŠå½¢è½‰æ› | `" å°ç©é›» "` â†’ `"å°ç©é›»"` |
| 2 | æ¨™æº–åŒ– | å¤§å°å¯«ã€æ—¥æœŸæ ¼å¼ | `fees01` â†’ `FEES01` |
| 3 | æ¨æ¸¬å¡«å€¼ | ç©ºå€¼å¡«é è¨­ | `NULL` â†’ `0` |
| 4 | è‡ªè¨‚è¦å‰‡ | æ¬„ä½å°ˆå±¬é‚è¼¯ | è² æ•¸åƒ¹æ ¼ â†’ `0` |

### 3.2 æ¸…ç†é †åº

```
åŸå§‹å€¼é€²å…¥
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±¤ç´š 1ï¼šæ ¼å¼æ¸…ç†             â”‚
â”‚ â€¢ TRIM é¦–å°¾ç©ºç™½              â”‚
â”‚ â€¢ ç§»é™¤ä¸å¯è¦‹å­—å…ƒ             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±¤ç´š 2ï¼šæ¨™æº–åŒ–               â”‚
â”‚ â€¢ å¤§å°å¯«çµ±ä¸€                 â”‚
â”‚ â€¢ æ—¥æœŸæ ¼å¼ â†’ YYYY-MM-DD     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±¤ç´š 3ï¼šæ¨æ¸¬å¡«å€¼             â”‚
â”‚ â€¢ ç©ºå€¼å¡«é è¨­å€¼               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±¤ç´š 4ï¼šè‡ªè¨‚è¦å‰‡             â”‚
â”‚ â€¢ ä¾ _metadata_cleansing_rules â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
         æ¸…ç†å®Œæˆ
```

### 3.3 æ¬„ä½ç¯©é¸ç­–ç•¥

**åŸå‰‡**ï¼šéæ¿¾ 90%+ ç©ºå€¼çš„æ¬„ä½

| åŸå§‹è¡¨ | åŸå§‹æ¬„ä½æ•¸ | æ¸…ç†å¾Œæ¬„ä½æ•¸ | éæ¿¾æ¯”ä¾‹ |
|--------|-----------|-------------|---------|
| erp_m2201_ima_file | 277 | 38 | 86% |
| erp_m2201_gem_file | 18 | 13 | 28% |
| erp_m2201_gen_file | 21 | 13 | 38% |

### 3.4 æ¬„ä½å‘½åè¦å‰‡

| åŸå‰‡ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|
| è‹±æ–‡å‘½å | ä½¿ç”¨æœ‰æ„ç¾©çš„è‹±æ–‡åç¨± | `ima01` â†’ `material_id` |
| è›‡å½¢å‘½å | snake_case æ ¼å¼ | `department_name` |
| ä¿ç•™åŸå§‹ ID | è¨˜éŒ„ä¾†æºç³»çµ±ç·¨è™Ÿ | `erp_material_id` |
| è¿½è¹¤æ¬„ä½ | ä¾†æºç³»çµ±ã€å»ºç«‹/æ›´æ–°æ™‚é–“ | `source_systems`, `created_at` |

---

## 4. åŸ·è¡Œæˆæœ

### 4.1 æ¸…ç†è¡¨ç¸½è¦½

#### material_masterï¼ˆæ–™ä»¶ä¸»æª”ï¼‰

| æŒ‡æ¨™ | æ•¸å€¼ |
|------|------|
| è³‡æ–™ç­†æ•¸ | 1,348 |
| æ¬„ä½æ•¸ | 38 |
| ä¾†æºè¡¨ | source.erp_m2201_ima_file |
| ä¸»éµ | material_id |

**ä¸»è¦æ¬„ä½**ï¼š

| æ¬„ä½ | ä¸­æ–‡å | è³‡æ–™é¡å‹ |
|------|--------|----------|
| material_id | æ–™ä»¶ç·¨è™Ÿ | TEXT (PK) |
| material_name | å“å | TEXT |
| specification | è¦æ ¼ | TEXT |
| category_code | åˆ†ç¾¤ç¢¼ | TEXT |
| stock_unit | åº«å­˜å–®ä½ | TEXT |
| is_active | æœ‰æ•ˆç¢¼ | TEXT |

---

#### department_masterï¼ˆéƒ¨é–€ä¸»æª”ï¼‰

| æŒ‡æ¨™ | æ•¸å€¼ |
|------|------|
| è³‡æ–™ç­†æ•¸ | 107 |
| æ¬„ä½æ•¸ | 13 |
| ä¾†æºè¡¨ | source.erp_m2201_gem_file |
| ä¸»éµ | department_id |

**ä¸»è¦æ¬„ä½**ï¼š

| æ¬„ä½ | ä¸­æ–‡å | è³‡æ–™é¡å‹ |
|------|--------|----------|
| department_id | éƒ¨é–€ç·¨è™Ÿ | TEXT (PK) |
| department_name | éƒ¨é–€åç¨± | TEXT |
| department_fullname | éƒ¨é–€å…¨ç¨± | TEXT |
| mgmt_category | ç®¡ç†é¡åˆ¥ | TEXT |
| is_active | æœ‰æ•ˆç¢¼ | TEXT |

---

#### employee_masterï¼ˆå“¡å·¥åŸºæœ¬è³‡æ–™ï¼‰

| æŒ‡æ¨™ | æ•¸å€¼ |
|------|------|
| è³‡æ–™ç­†æ•¸ | 1,326 |
| æ¬„ä½æ•¸ | 13 |
| ä¾†æºè¡¨ | public.erp_m2201_gen_file |
| ä¸»éµ | employee_id |

**ä¸»è¦æ¬„ä½**ï¼š

| æ¬„ä½ | ä¸­æ–‡å | è³‡æ–™é¡å‹ |
|------|--------|----------|
| employee_id | å“¡å·¥ç·¨è™Ÿ | TEXT (PK) |
| employee_name | å“¡å·¥å§“å | TEXT |
| department_code | éƒ¨é–€ä»£ç¢¼ | TEXT |
| employee_type | å“¡å·¥é¡å‹ | TEXT |
| is_active | æœ‰æ•ˆç¢¼ | TEXT |

---

### 4.2 Metadata å»ºç«‹æˆæœ

```sql
-- æŸ¥è©¢ç¯„ä¾‹
SELECT * FROM clean._metadata_table;
SELECT * FROM clean._metadata_column WHERE table_name = 'clean.material_master';
SELECT * FROM clean._metadata_column_mapping WHERE target_table = 'clean.material_master';
```

---

## 5. è³‡æ–™å“è³ªæª¢æ¸¬

### 5.1 æª¢æ¸¬çµæœæ‘˜è¦

| æª¢æ¸¬é …ç›® | material_master | department_master | employee_master |
|----------|-----------------|-------------------|-----------------|
| ç¸½ç­†æ•¸ | 1,348 | 107 | 1,326 |
| ä¸»éµå”¯ä¸€æ€§ | âœ… 100% | âœ… 100% | âœ… 100% |
| åç¨±ç©ºå€¼ | âœ… 0 ç­† | âœ… 0 ç­† | âœ… 0 ç­† |
| is_active ç©ºå€¼ | âœ… 0 ç­† | âœ… 0 ç­† | âœ… 0 ç­† |

### 5.2 ç™¼ç¾çš„å•é¡Œ

#### âš ï¸ å•é¡Œ 1ï¼šis_active å€¼ä¸çµ±ä¸€

| è¡¨ | å€¼åˆ†å¸ƒ | å•é¡Œ |
|---|---|---|
| material_master | Y(1336), N(11), **P(1)** | P å€¼æ„ç¾©ä¸æ˜ |
| employee_master | Y(417), N(889), **E(20)** | E å€¼æ„ç¾©ä¸æ˜ |
| department_master | Y(107) | å…¨éƒ¨æœ‰æ•ˆ |

**ç•°å¸¸è³‡æ–™ç¯„ä¾‹**ï¼š
- `MISC-FEEA911` è£½é€ è²»-ç§Ÿé‡‘æ”¯å‡º â†’ is_active = `P`

---

#### âš ï¸ å•é¡Œ 2ï¼šé—œè¯å®Œæ•´æ€§

**76 åå“¡å·¥çš„éƒ¨é–€ä»£ç¢¼åœ¨ department_master æ‰¾ä¸åˆ°å°æ‡‰**

| å“¡å·¥ department_code | department_master ä¸­ |
|---------------------|---------------------|
| BB02-005 | ä¸å­˜åœ¨ |
| BA00-003 | ä¸å­˜åœ¨ |

**å¯èƒ½åŸå› **ï¼šéƒ¨é–€ä»£ç¢¼æ ¼å¼ä¸ä¸€è‡´ï¼ˆå“¡å·¥ç”¨ `BB02-005`ï¼Œéƒ¨é–€è¡¨å¯èƒ½æ˜¯ `BB02`ï¼‰

---

#### âš ï¸ å•é¡Œ 3ï¼šID å¤§å°å¯«ä¸ä¸€è‡´

| è¡¨ | å«å°å¯« | å«å¤§å¯« |
|---|---|---|
| employee_id | 21 ç­† | 92 ç­† |
| material_id | 0 ç­† | 236 ç­† |
| department_id | 0 ç­† | 107 ç­† |

---

### 5.3 å“è³ªåˆ†æ•¸

| ç¶­åº¦ | åˆ†æ•¸ | èªªæ˜ |
|------|------|------|
| å®Œæ•´æ€§ | 95% | ä¸»éµå’Œåç¨±æ¬„ä½å®Œæ•´ |
| ä¸€è‡´æ€§ | 80% | is_active å€¼éœ€æ¨™æº–åŒ– |
| æº–ç¢ºæ€§ | 90% | å¾…ç¢ºèªç•°å¸¸ç‹€æ…‹ç¢¼ |
| é—œè¯æ€§ | 94% | 76/1326 å“¡å·¥éƒ¨é–€é—œè¯å¤±æ•— |
| **ç¸½åˆ†** | **90%** | è‰¯å¥½ï¼Œæœ‰æ”¹å–„ç©ºé–“ |

---

## 6. å»ºè­°äº‹é …

### 6.1 çŸ­æœŸæ”¹å–„ï¼ˆç«‹å³å¯åšï¼‰

#### å»ºè­° 1ï¼šå»ºç«‹ç‹€æ…‹ç¢¼å°ç…§è¡¨

```sql
CREATE TABLE clean.status_mapping (
    table_name TEXT,
    original_value TEXT,
    standard_value TEXT,
    description TEXT,
    PRIMARY KEY (table_name, original_value)
);

INSERT INTO clean.status_mapping VALUES
('material_master', 'Y', 'ACTIVE', 'æœ‰æ•ˆ'),
('material_master', 'N', 'INACTIVE', 'åœç”¨'),
('material_master', 'P', 'PENDING', 'å¾…ç¢ºèª'),
('employee_master', 'Y', 'ACTIVE', 'åœ¨è·'),
('employee_master', 'N', 'INACTIVE', 'åœç”¨'),
('employee_master', 'E', 'RESIGNED', 'é›¢è·');
```

#### å»ºè­° 2ï¼šçµ±ä¸€ ID å¤§å°å¯«

```sql
UPDATE clean.employee_master 
SET employee_id = UPPER(employee_id);
```

#### å»ºè­° 3ï¼šæ–°å¢æ¨™æº–åŒ–ç‹€æ…‹æ¬„ä½

```sql
ALTER TABLE clean.material_master ADD COLUMN status TEXT;
ALTER TABLE clean.employee_master ADD COLUMN status TEXT;

UPDATE clean.material_master SET status = 
    CASE is_active 
        WHEN 'Y' THEN 'ACTIVE'
        WHEN 'N' THEN 'INACTIVE'
        WHEN 'P' THEN 'PENDING'
    END;
```

---

### 6.2 ä¸­æœŸæ”¹å–„

#### å»ºè­° 4ï¼šå»ºç«‹éƒ¨é–€ä»£ç¢¼å°ç…§è¡¨

è§£æ±º `BB02-005` vs `BB02` çš„é—œè¯å•é¡Œ

#### å»ºè­° 5ï¼šå¯¦ä½œè‡ªå‹•åŒ– ETL Pipeline

ä½¿ç”¨ Mage.AI æˆ–é¡ä¼¼å·¥å…·è‡ªå‹•åŸ·è¡Œæ¸…ç†æµç¨‹

#### å»ºè­° 6ï¼šå»ºç«‹è³‡æ–™å“è³ªå„€è¡¨æ¿

ç›£æ§æ¯æ¬¡ ETL çš„æˆåŠŸç‡ã€å¤±æ•—ç‡ã€ä¿®æ­£æ•¸é‡

---

### 6.3 é•·æœŸè¦åŠƒ

#### å»ºè­° 7ï¼šæ“´å±•åˆ°å…¶ä»–ç³»çµ±

- WMS å€‰å„²ç³»çµ±
- MES è£½é€ ç³»çµ±
- æ•´åˆåˆ° material_master çš„ `wms_material_id`, `mes_material_id` æ¬„ä½

#### å»ºè­° 8ï¼šå»ºç«‹ mart å±¤

ç‚º BI å ±è¡¨å’Œ AI æŸ¥è©¢å»ºç«‹ç¶­åº¦è¡¨å’Œäº‹å¯¦è¡¨

---

## 7. é™„éŒ„

### 7.1 æŸ¥è©¢ç¯„ä¾‹

```sql
-- æŸ¥è©¢æœ‰æ•ˆæ–™ä»¶
SELECT material_id, material_name, stock_unit
FROM clean.material_master
WHERE is_active = 'Y';

-- æŸ¥è©¢å“¡å·¥èˆ‡éƒ¨é–€é—œè¯
SELECT 
    e.employee_id,
    e.employee_name,
    d.department_name
FROM clean.employee_master e
LEFT JOIN clean.department_master d 
    ON e.department_code = d.department_id
WHERE e.is_active = 'Y';

-- æŸ¥è©¢æ¬„ä½è¡€ç·£
SELECT target_column, source_system, source_table, source_column
FROM clean._metadata_column_mapping
WHERE target_table = 'clean.material_master';
```

### 7.2 ç›¸é—œæ–‡ä»¶

| æ–‡ä»¶ | èªªæ˜ |
|------|------|
| è³‡æ–™æ¸…ç†è¨­è¨ˆæ–‡ä»¶ | Medallion Architecture è¨­è¨ˆè¦ç¯„ |
| _metadata_cleansing_rules | æ¸…ç†è¦å‰‡å®šç¾© |
| _metadata_validation_rules | é©—è­‰è¦å‰‡å®šç¾© |

---

## ç‰ˆæœ¬ç´€éŒ„

| æ—¥æœŸ | ç‰ˆæœ¬ | èªªæ˜ | åŸ·è¡Œè€… |
|------|------|------|--------|
| 2026-02-05 | 1.0 | å»ºç«‹ clean schemaã€material_master | meimei |
| 2026-02-05 | 1.1 | å»ºç«‹ Metadata ä¸ƒè¡¨ | meimei |
| 2026-02-07 | 1.2 | æ–°å¢ department_masterã€employee_master | meimei |
| 2026-02-09 | 1.3 | å®Œæˆå“è³ªæª¢æ¸¬å ±å‘Š | meimei |

---

*å ±å‘Šç”¢ç”Ÿæ™‚é–“ï¼š2026-02-09*  
*ç”¢ç”Ÿè€…ï¼šmeimei (AI Data Engineer)*
